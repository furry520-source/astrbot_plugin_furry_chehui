# 自动撤回插件 (AstrBot Plugin Furry Chehui)

一个智能的机器人自动撤回插件，支持定时撤回机器人发送的所有消息，包括LLM回复和其他插件消息。

## 访问量
![Moe Counter](https://moe.tans.fun/@furry520-source-chehui?theme=asoul&padding=7&scale=1)

## 功能特性

### 智能撤回
- **定时撤回**: 可配置的撤回时间，支持秒级精度
- **全面覆盖**: 撤回所有机器人消息，包括：
  - 本插件命令回复
  - LLM智能对话回复  
  - 其他插件功能消息
  - 系统自动回复

### 精准控制
- **私聊/群聊分离**: 独立控制私聊和群聊的撤回功能
- **白名单机制**: 支持群聊白名单，精确控制生效范围
- **全局生效**: 真正意义上的所有消息撤回，不限于本插件

### 灵活配置
- **撤回时间**: 自由设置撤回等待时间（1-600秒）
- **开关控制**: 独立启用/禁用私聊和群聊功能
- **权限管理**: 白名单群组管理

## 快速开始

### 安装插件
1. 在 AstrBot 插件市场中搜索 `astrbot_plugin_furry_chehui`
2. 点击安装并启用插件

### 基础配置
在插件配置页面设置：

```

撤回时间: 10          # 消息发送后10秒撤回
启用私聊撤回: true    # 开启私聊消息撤回
启用群聊撤回: true    # 开启群聊消息撤回
白名单群聊: []        # 空数组表示所有群聊生效

```

### 使用命令
```

/recall_config        # 查看当前配置
/test_all_recall      # 测试撤回功能

```

## 详细配置说明

### 撤回时间 (recall_time)
**类型**: 整数  
**范围**: 1-600 秒  
**默认**: 10秒  
**说明**: 机器人发送消息后等待多少秒自动撤回

### 启用私聊撤回 (enable_private_recall)
**类型**: 布尔值  
**默认**: true  
**说明**: 是否在私聊对话中启用撤回功能

### 启用群聊撤回 (enable_group_recall)
**类型**: 布尔值  
**默认**: true  
**说明**: 是否在群聊中启用撤回功能

### 白名单群聊 (group_whitelist)
**类型**: 字符串数组  
**默认**: [] (空数组)  
**说明**: 只有列表中的群号会启用撤回功能，留空表示所有群聊都生效

## 使用场景

### 临时信息场景
- 发送验证码、临时链接等敏感信息
- 临时通知、提醒消息
- 测试环境中的调试信息

### 隐私保护场景
- 保护对话隐私，自动清理聊天记录
- 防止敏感信息长期留存
- 临时会话的自动清理

### 用户体验场景
- 避免聊天界面被机器人消息刷屏
- 提供"阅后即焚"式体验
- 减少不必要的消息堆积

## 技术特性

### 高性能
- 异步任务管理，不影响机器人响应速度
- 智能消息ID获取，确保撤回准确性
- 内存优化，长时间运行稳定

### 高兼容性
- 支持 AstrBot 所有消息类型
- 兼容 LLM 和其他插件消息

### 高可靠性
- 异常处理机制，避免插件崩溃
- 任务生命周期管理
- 完善的日志记录

## 常见问题

**Q: 为什么有些消息没有撤回？**  
A: 请检查：
1. 插件配置是否正确保存
2. 当前会话是否在白名单内
3. 网络连接是否正常
4. 查看插件日志排查问题

**Q: 如何调整撤回时间？**  
A: 在插件配置页面修改"撤回时间"参数，支持1-600秒。

**Q: 可以只撤回LLM消息吗？**  
A: 当前版本支持撤回所有机器人消息，包括LLM消息。

**Q: 插件会影响机器人性能吗？**  
A: 插件采用异步设计，对性能影响极小。

## 更新日志

### v1.0.0
- ✅ 基础撤回功能
- ✅ 全局消息覆盖
- ✅ 配置化管理
- ✅ 白名单机制

---

让聊天更清爽，让信息更安全！ 🎉